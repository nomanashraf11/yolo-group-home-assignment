<div class="tasks-list">
  <ng-container *ngIf="!isLoading; else loading">
    <ng-container *ngIf="tasks.length > 0; else noTasks">
      <table mat-table [dataSource]="tasks" class="mat-elevation-z1">
        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef>Title</th>
          <td mat-cell *matCellDef="let task">
            <div class="task-title">
              <span>{{ task.title }}</span>
              <app-status-badge
                [status]="task.status"
                size="sm"
              ></app-status-badge>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="dueDate">
          <th mat-header-cell *matHeaderCellDef>Due Date</th>
          <td mat-cell *matCellDef="let task">
            {{ task.dueDate | date:'mediumDate' }}
          </td>
        </ng-container>

        <ng-container matColumnDef="category" *ngIf="showCategoryColumn">
          <th mat-header-cell *matHeaderCellDef>Category</th>
          <td mat-cell *matCellDef="let task">
            <span *ngIf="task.categoryId">
              {{ getCategoryName(task.categoryId) }}
            </span>
            <span *ngIf="!task.categoryId" class="no-category">-</span>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="actions-header">
            Actions
          </th>
          <td mat-cell *matCellDef="let task">
            <ng-content
              select="[actions]"
              [ngTemplateOutletContext]="{ $implicit: task }"
            ></ng-content>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </ng-container>
  </ng-container>

  <ng-template #loading>
    <div class="loading-message">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading tasks...</p>
    </div>
  </ng-template>

  <ng-template #noTasks>
    <div class="no-tasks-message">
      <mat-icon>assignment</mat-icon>
      <p>No tasks found</p>
    </div>
  </ng-template>
</div>
