<div class="categories-container">
  <ng-container *ngIf="!isLoading; else loading">
    <ng-container *ngIf="categories.length > 0; else noCategories">
      <div class="category-accordion">
        <div
          class="category-item"
          *ngFor="let category of categories; trackBy: trackByCategoryId"
          [class.expanded]="isCategoryExpanded(category.id)"
        >
          <div class="category-header" (click)="toggleCategory(category.id)">
            <div class="header-content">
              <div class="accordion-icon">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M12 10L8 6L4 10"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <div class="category-info">
                <h3 class="category-title">{{ category.title }}</h3>
                <div class="category-description">
                  {{ category.description || 'No description provided' }}
                </div>
                <div class="category-meta">
                  <span class="task-count">
                    {{ category.tasks?.length || 0 }} tasks
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div
            class="category-content"
            [@expandCollapse]="isCategoryExpanded(category.id)"
          >
            <div class="content-inner">
              <div class="tasks-section">
                <div class="tasks-list">
                  <div
                    *ngIf="(category.tasks?.length || 0) === 0"
                    class="no-tasks"
                  >
                    <p>No tasks in this category</p>
                  </div>
                  <div
                    *ngFor="let task of category.tasks || []"
                    class="task-item"
                  >
                    <div class="task-main">
                      <div class="task-title">{{ task.title }}</div>
                      <div class="task-meta">
                        <app-status-badge
                          [status]="task.status"
                          size="sm"
                        ></app-status-badge>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </ng-container>

  <ng-template #loading>
    <div class="loading-state">
      <div class="loading-spinner">
        <mat-spinner diameter="48"></mat-spinner>
      </div>
      <p>Loading your categories...</p>
    </div>
  </ng-template>

  <ng-template #noCategories>
    <div class="empty-state">
      <div class="empty-icon">
        <mat-icon>folder_off</mat-icon>
      </div>
      <h3>No categories found</h3>
      <p>Create your first category to get started</p>
    </div>
  </ng-template>
</div>
